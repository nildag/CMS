{% extends 'base.html' %}

{% load static %}

{% block content %}
  <!DOCTYPE html>
  <html lang="es">

    <head>

      <meta charset="UTF-8">

      <!-- Agregamos la hoja de estilos -->
      <link rel="stylesheet" type="text/css" href="{% static 'rol/styles.css' %}">

      <!-- Agregamos los scripts de Bootstrap -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
      
      <title>Roles</title>
      
    </head>

    <body>

      <div id="listaRoles">

        <table style="width: 100%;">
          <tr>
              <td style="width: 85%;">
                <h1>Roles</h1>
              </td>
              <td style="width: 15%;">
                <form method="get" action="{% url 'rol:crear_rol' %}">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-primary float-right">Crear Rol</button>
                </form>
              </td>
          </tr>
          <!-- Agrega más filas según sea necesario -->
        </table>
      
        <div class="accordion" id="accordionExample">

          <table class="table">

            <thead>
              <tr>
                <th scope="col">Nombre</th>
                <th scope="col">Descripcion</th>
                <th scope="col">Permisos</th>
                <th scope="col"></th>
                <th scope="col"></th>
              </tr>
            </thead>

            <tbody>
              {% for rol in roles %}
                <tr>
                  <td>{{ rol.nombre }}</td>
                  <td>{{ rol.descripcion }}</td>
                  <td>
                      
                    <div class="accordion-item">

                      <h2 class="accordion-header" id="heading-{{forloop.counter}}">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{forloop.counter}}" aria-expanded="false" aria-controls="collapse-{{forloop.counter}}">
                          Permisos
                        </button>
                      </h2>

                      <div id="collapse-{{forloop.counter}}" class="accordion-collapse collapse" aria-labelledby="heading-{{forloop.counter}}" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                          <ul>
                            {% for permiso in rol.permisos.all %}
                              <li>
                                {{ permiso.nombre }}
                              </li>
                            {% endfor %}
                          </ul>
                        </div>
                      </div>
                        
                    </div>
                          
                  </td>

                  <td>
                    <form method="post" action="{% url 'rol:borrar_rol' rol.id %}">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-danger">Borrar</button>
                    </form>
                  </td>

                  <td>
                    <form method="get" action="{% url 'rol:editar_rol' rol.id %}">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-secondary">Modificar</button>
                    </form>
                  </td>

                </tr>
              {% endfor %}

            </tbody>
          </table>
        </div>

      </div>
      
    </body>
  </html>
{% endblock %}